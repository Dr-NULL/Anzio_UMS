<mat-card>
  <mat-card-title>Importar Usuarios</mat-card-title>
  <mat-card-subtitle></mat-card-subtitle>
  <mat-divider></mat-divider>
  <mat-card-content>
    <mat-vertical-stepper [linear]="true" #stepper>
      <mat-step [completed]="complete[0]">
        <ng-template matStepLabel>Importar CSV con toda la data:</ng-template>
        <div>
          <app-file-picker [(value)]="file" accept=".csv,.xls,.xlsx" (change)="onStep1change()"></app-file-picker>
        </div>
        <mat-progress-bar *ngIf="loading" mode="indeterminate"></mat-progress-bar>
        <div class="action">
          <button h="btnStep1" mat-raised-button color="accent" (click)="onStep1Click()" disabled>
            <span>Subir Archivo</span>
          </button>
        </div>
      </mat-step>
      <mat-step [completed]="complete[1]">
        <ng-template matStepLabel>Usuarios que se Agregar치n:</ng-template>
        <mat-form-field>
          <input matInput type="text" (keyup)="onTableVincFilter($event.target.value)" placeholder="Filtrar:" />
        </mat-form-field>
        <table mat-table [dataSource]="tableVinc.data">
          <ng-container matColumnDef="rut">
            <th mat-header-cell *matHeaderCellDef>RUT</th>
            <td mat-cell *matCellDef="let item">{{ item.rut }}</td>
          </ng-container>
          <ng-container matColumnDef="nombre">
            <th mat-header-cell *matHeaderCellDef>Nombre</th>
            <td mat-cell *matCellDef="let item">{{ item.nombres }} {{ item.apellidoP }} {{ item.apellidoM }}</td>
          </ng-container>
          <ng-container matColumnDef="area">
            <th mat-header-cell *matHeaderCellDef>Area</th>
            <td mat-cell *matCellDef="let item">{{ item.area }}</td>
          </ng-container>
          <ng-container matColumnDef="cargo">
            <th mat-header-cell *matHeaderCellDef>Cargo</th>
            <td mat-cell *matCellDef="let item">{{ item.cargo }}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="tableVinc.show"></tr>
          <tr mat-header-row *matRowDef="let row; columns: tableVinc.show"></tr>
        </table>
        <mat-paginator #tableVincPage [pageSizeOptions]="[10, 10, 15]" showFirstLastButtons></mat-paginator>
        <div class="action">
          <button mat-raised-button color="primary" (click)="onStep2Click(false)">
            <span>Anterior</span>
          </button>
          <button mat-raised-button color="accent" (click)="onStep2Click(true)">
            <span>Siguiente</span>
          </button>
        </div>
      </mat-step>
      <mat-step [completed]="complete[2]">
        <ng-template matStepLabel>Usuarios que se Revisar치n:</ng-template>
        <mat-form-field>
          <input matInput type="text" (keyup)="onTableEditFilter($event.target.value)" placeholder="Filtrar:" />
        </mat-form-field>
        <table mat-table [dataSource]="tableEdit.data">
          <ng-container matColumnDef="rut">
            <th mat-header-cell *matHeaderCellDef>RUT</th>
            <td mat-cell *matCellDef="let item">{{ item.rut }}</td>
          </ng-container>
          <ng-container matColumnDef="nombre">
            <th mat-header-cell *matHeaderCellDef>Nombre</th>
            <td mat-cell *matCellDef="let item">{{ item.nombres }} {{ item.apellidoP }} {{ item.apellidoM }}</td>
          </ng-container>
          <ng-container matColumnDef="area">
            <th mat-header-cell *matHeaderCellDef>Area</th>
            <td mat-cell *matCellDef="let item">{{ item.area }}</td>
          </ng-container>
          <ng-container matColumnDef="cargo">
            <th mat-header-cell *matHeaderCellDef>Cargo</th>
            <td mat-cell *matCellDef="let item">{{ item.cargo }}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="tableEdit.show"></tr>
          <tr mat-header-row *matRowDef="let row; columns: tableEdit.show"></tr>
        </table>
        <mat-paginator #tableEditPage [pageSizeOptions]="[10, 10, 15]" showFirstLastButtons></mat-paginator>
        <div class="action">
          <button mat-raised-button color="primary" (click)="onStep3Click(false)">
            <span>Anterior</span>
          </button>
          <button mat-raised-button color="accent" (click)="onStep3Click(true)">
            <span>Siguiente</span>
          </button>
        </div>
      </mat-step>
      <mat-step [completed]="complete[3]">
        <ng-template matStepLabel>Usuarios que se Desvincular치n:</ng-template>
        <mat-form-field>
          <input matInput type="text" (keyup)="onTableDesvFilter($event.target.value)" placeholder="Filtrar:" />
        </mat-form-field>
        <table mat-table [dataSource]="tableDesv.data">
          <ng-container matColumnDef="rut">
            <th mat-header-cell *matHeaderCellDef>RUT</th>
            <td mat-cell *matCellDef="let item">{{ item.rut }}</td>
          </ng-container>
          <ng-container matColumnDef="nombre">
            <th mat-header-cell *matHeaderCellDef>Nombre</th>
            <td mat-cell *matCellDef="let item">{{ item.nombres }} {{ item.apellidoP }} {{ item.apellidoM }}</td>
          </ng-container>
          <ng-container matColumnDef="area">
            <th mat-header-cell *matHeaderCellDef>Area</th>
            <td mat-cell *matCellDef="let item">{{ item.area.descripc }}</td>
          </ng-container>
          <ng-container matColumnDef="cargo">
            <th mat-header-cell *matHeaderCellDef>Cargo</th>
            <td mat-cell *matCellDef="let item">{{ item.cargo.descripc }}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="tableDesv.show"></tr>
          <tr mat-header-row *matRowDef="let row; columns: tableDesv.show"></tr>
        </table>
        <mat-paginator #tableDesvPage [pageSizeOptions]="[10, 10, 15]" showFirstLastButtons></mat-paginator>
        <div class="action">
          <button mat-raised-button color="primary" (click)="onStep4Click(false)">
            <span>Anterior</span>
          </button>
          <button mat-raised-button color="accent" (click)="onStep4Click(true)">
            <span>Migrar Usuarios</span>
          </button>
        </div>
      </mat-step>
      <mat-step [completed]="complete[4]">
        <ng-template matStepLabel>Resultados:</ng-template>
        <div class="loading" *ngIf="loading">
          <mat-spinner></mat-spinner>
        </div>
        <div *ngIf="!loading">
          <p>La Migraci칩n se ha realizado correctamente!</p>
          <div class="action">
            <button mat-raised-button color="primary" (click)="onReset()">
              <span>Reimportar...</span>
            </button>
          </div>
        </div>
      </mat-step>
    </mat-vertical-stepper>
  </mat-card-content>
</mat-card>
